(function(e){function t(t){for(var r,i,c=t[0],s=t[1],u=t[2],d=0,l=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&l.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);p&&p(t);while(l.length)l.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var p=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("d3b7");var r=n("53ca"),a=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),o=n("bc3a"),i=n.n(o),c=n("72bf"),s=n.n(c),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.isGood?n("span",[e._v("Processing...")]):e._e(),e.isError?n("span",[e._v(e._s(e.isError))]):e._e(),e.responseRedirect?n("redirect-post-form",{attrs:{response:e.responseRedirect}}):e._e(),e._m(0)],1)},p=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{id:"challengeForm"}},[n("input",{attrs:{type:"hidden",name:"threeDSMethodData",id:"threeDSMethodData"}})])}],d=(n("b0c0"),n("ac1f"),n("3ca3"),n("841c"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),l=(n("99af"),n("d4ec")),f=n("bee2"),w=function(){var e=window&&window.screen?window.screen.width:1,t=window&&window.screen?window.screen.height:1,n=window&&window.screen?window.screen.colorDepth:16,r=window&&window.navigator?window.navigator.userAgent:"_",a=!(!window||!window.navigator)&&navigator.javaEnabled(),o="ru";window&&window.navigator&&(o=window.navigator.language?window.navigator.language:window.navigator.browserLanguage);var i=(new Date).getTimezoneOffset(),c={version:window.settings.threeDSV2.version,"device.channel":"BRW","device.browserScreenWidth":e,"device.browserScreenHeight":t,"device.browserColorDepth":n,"device.browserUserAgent":r,"device.browserTZ":i,"device.browserLanguage":o,"device.browserJavaEnabled":a,"device.browserJavascriptEnabled":!0,challengeWindowSize:"04"};return c},h=w,m=function(){function e(){Object(l["a"])(this,e)}return Object(f["a"])(e,null,[{key:"state",value:function(e,t){return a["a"].http.get("".concat(t,"/payment/").concat(e,"/continue"))}},{key:"stateToken",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",a["a"].http.get("".concat(n,"/payment/").concat(t,"/continue")));case 1:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"start",value:function(e,t,n){return a["a"].http.post("".concat(n,"/payment/").concat(e,"/start"),t)}},{key:"threedsV2prepare",value:function(e,t){var n=h();return a["a"].http.post("".concat(t,"/payment/").concat(e,"/3ds2-prepare/accept"),n)}},{key:"getToken",value:function(e){return a["a"].http.post("".concat(e,"/token"))}},{key:"decline",value:function(e,t){return a["a"].http.post("".concat(t,"/payment/").concat(e,"/decline"))}},{key:"accept",value:function(e,t){return a["a"].http.post("".concat(t,"/payment/").concat(e,"/accept"))}},{key:"authConfirm",value:function(e,t,n){return a["a"].http.post("".concat(n,"/payment/").concat(e,"/authentication-confirm"),t)}},{key:"authDecline",value:function(e,t){return a["a"].http.post("".concat(t,"/payment/").concat(e,"/authentication-decline"))}},{key:"authRepeat",value:function(e,t){return a["a"].http.post("".concat(t,"/payment/").concat(e,"/authentication-repeat"))}}]),e}(),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{action:e.response.url,method:"post",target:"_self"}},e._l(e.response.post,(function(e,t){return n("input",{key:t,attrs:{type:"hidden",name:t},domProps:{value:e}})})),0)},g=[],b={name:"RedirectPostForm",props:{response:{type:Object,required:!0}},mounted:function(){this.$el.submit()}},k=b,y=n("2877"),R=Object(y["a"])(k,v,g,!1,null,null,null),E=R.exports,S={OFFER:"offer",RESULT:"result",REDIRECT:"redirect",IN_PROGRESS:"in_progress",AUTHENTICATION:"authentication",THREEDS2PREPARE:"3ds2_prepare",IFRAME:"iframe"},x={name:"App",components:{RedirectPostForm:E},data:function(){return{responseRedirect:null,hiddenIframe:null,isGood:!0,isError:!1,response:null,hiddenFrameWasExist:!1,lastExecutionTime:parseInt(Date.now()/1e3),isStopCheckState:!1,isWasReloaded:!1}},methods:{createHiddenIframe:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=document.getElementById("app"),a=document.createElement("iframe"),a.name="challengeIframe",a.display="none",r.appendChild(a),o=document.getElementById("challengeForm"),e.post?(document.getElementById("threeDSMethodData").value=e.post.threeDSMethodData,o.method="post"):o.method="get",o.action=e.url,o.target="challengeIframe",a.appendChild(o),o.submit(),t.hiddenFrameWasExist=!0,t.hiddenIframe=!0;case 13:case"end":return n.stop()}}),n)})))()},checkStatePayment:function(e,t,n){var r=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:o=e.state,a.t0=o,a.next=a.t0===S.IN_PROGRESS?4:a.t0===S.THREEDS2PREPARE?6:a.t0===S.IFRAME?8:a.t0===S.REDIRECT?17:20;break;case 4:return m.stateToken(t,n).then(function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.checkStatePayment(a,t,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){})),a.abrupt("break",20);case 6:return m.threedsV2prepare(t,n).then(function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.checkStatePayment(a,t,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.abrupt("break",20);case 8:if(r.response=e,"SIZED"===e.iframeMode&&(i=new URL(window.location.href),i.searchParams.set("reload",!0),window.history.replaceState(null,null,i),window.location.reload()),"HIDDEN"!==e.iframeMode||r.hiddenFrameWasExist){a.next=15;break}return a.next=13,r.createHiddenIframe(e);case 13:clearInterval(window.timer),window.timer=setInterval(Object(d["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m.stateToken(r.token,r.portal);case 2:t=e.sent,"SIZED"===t.iframeMode?(n=new URL(window.location.href),n.searchParams.set("reload",!0),window.history.replaceState(null,null,n),window.location.reload()):t.state===S.REDIRECT&&(window.location.href=t.url);case 4:case"end":return e.stop()}}),e)}))),5e3);case 15:return e.post&&"SIZED"===e.iframeMode&&!r.isStopCheckState&&r.isWasReloaded&&(r.isStopCheckState=!0,r.responseRedirect=e),a.abrupt("break",20);case 17:return window.scrollTo(0,0),e.post?r.responseRedirect=e:window.location.href=e.url,a.abrupt("break",20);case 20:case"end":return a.stop()}}),a)})))()}},created:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,r,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=window.location.search,r=new URLSearchParams(n),e.token=r.get("token"),e.portal=r.get("portal"),e.isWasReloaded=!!r.get("reload"),!0!==window.settings.isDebug){t.next=17;break}return t.next=8,m.getToken(e.portal);case 8:if(a=t.sent,e.token=r.get("token")||a.token,o=new URL(window.location.href),o.searchParams.set("token",e.token),window.history.replaceState(null,null,o),i={},e.isWasReloaded){t.next=17;break}return t.next=17,m.start(e.token,i,e.portal);case 17:if(e.token){t.next=21;break}return e.isGood=!1,e.isError="Parameter token is required",t.abrupt("return");case 21:if(e.portal){t.next=25;break}return e.isGood=!1,e.isError="Parameter portal is required",t.abrupt("return");case 25:try{m.stateToken(e.token,e.portal).then(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.checkStatePayment(n,e.token,e.portal);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.isGood=!1,e.isError=t.data.error}))}catch(c){console.log(c),e.isGood=!1,e.isError=c.data.error}case 26:case"end":return t.stop()}}),t)})))()}},O=x,P=(n("034f"),Object(y["a"])(O,u,p,!1,null,null,null)),j=P.exports,_=i.a.create({baseURL:"".concat(window.settings.openApi.url),transformRequest:[function(e,t){return t["content-type"]="application/x-www-form-urlencoded",e}]});_.interceptors.request.use((function(e){if(e&&"object"===Object(r["a"])(e.data))for(var t in e.data)e.data[t]||!1===e.data[t]||0===e.data[t]||delete e.data[t];return e.data=s.a.stringify(e.data),e})),_.interceptors.response.use((function(e){return e.data}),(function(e){var t=e.response,n=void 0===t?{data:{error:e}}:t;return Promise.reject(n)})),a["a"].prototype.$http=a["a"].http=_,a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(j)}}).$mount("#app")},"85ec":function(e,t,n){}});
//# sourceMappingURL=app.abec8087.js.map